# [4장] 예외

### 목표

- ***JdbcTemplate를 대표하는 스프링 데이터액세스기능에 담겨있는 예외처리와 관련된 접근방법에 대해 공부한다.***

---

### 4.1 사라진 SQLException

- jdbcTemplate를 사용하면서 SQLException throws가 없어졌다.

<aside>
📌 예외 블랙홀
try{…}catch(SQLException e) {}//예외를 잡지만 아무것도 하지않는다.

</aside>

- 위와 같은 습관은 예상치못한 결과로 이어진다.(예외 발생보다 더 안좋은 습관)

```java
catch(SQLexception e){
	System.out.println(e);
	e.printStackTrace();
	//둘 또한 아주 심각한 에러 이슈다.
}
```

<aside>
📌 ***모든 예외는 적절히 복구 되든지 아니면 작업을 중지시켜 개발자에게 통보되어야 한다.***

</aside>

- `System.exit(1);` 와 같이 시스템을 종료시키는게 그나마 더 나은 예외 처리가 된다.

---

### 체크예외

- throw를 통한 예외는 크게 3가지로 다음과 같다.
    - Error - Error클래스의 서브클래스
    - Exception과 체크 예외,언체크예외(RuntimeException 클래스의 상속 유무)
    - RuntimeException과 언체크/런타임 예외 - `NullPointerException` 혹은 `IllegalArgumentExpceion` 등이 있다.
- 일반적으로 체크예외는 일반적인 예외를 다루며, 언체크 예외는 시스템 장애나 프로그램상의 오류로 사용한다.

---

### 예외처리 방법

- 예외복구 - 예외로 인한 기본작업 흐름이 불가능하다면 다른 작업 흐름으로 유도 해주는 방법.
- 예외처리 회피 - 자신을 호출한 쪽으로 예외를 던져버리는 것.(단, 의도가 분명해야 된다.)
- 예외 전환 - 예외를 메소드밖으로 던지되, 적절한 예외로 전환해서 던진다.
    - 상위 메소드에서 적절하게 처리할 수 있도록 예외를 예측가능한 에러로 전환한다.

---

### 예외처리 전략

1. 대응이 불가능한 체크예외라면 빨리 런타임에러로 전환하는게 나을 수 있다. 런타임 예외처리
2. add() 메소드의 예외처리

```java
public void add() throws DuplcateUserIdException{
	try{...}
	catch(SQLException e){
		if(e.getErrorCode() == MysqlErrorNumbers.ER_DUP_ENTRY)
			throw new DuplicateUserIdException(e);//예외전환
		else
			throw new RuntimeException(e); //예외포장
	}
}
```

1. 애플리케이션 예외 - 앱 자체의 로직에 의해 의도적으로 발생시키고 반드시 catch 해서 무엇인가 조치를 취하도록 요구하는 예외.

---

- 대부분의 SQLException 에러는 복구가 불가능하다. —> 예외처리 전략을 적용해야 한다.
    - 빠르게 언체크/런타임 예외로 전환하여 준다.
- 스프링의 JdbcTemplate과 콜백 안에서 발생하는 모든 SQLException을 런타임 예외인 DataAccessException으로 포장하여 던져준다. → SQLException이 사라진 이유.
(대부분의 복구불가능한 예외에 대해 애플리케이션 레벨에서는 신경쓰지 않도록 해줌)

---

### 4.2 예외 전환

- 런타임예외로 포장(전환) 하거나 ***로우레벨의 예외를 좀더 추상화된 예외로 전환***